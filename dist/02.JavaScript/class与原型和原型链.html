<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>class 与原型和原型链 | knowledge</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/front-end-knowledge/favicon.ico">
    <meta name="description" content="Let's learn together">
    <link rel="preload" href="/front-end-knowledge/assets/css/0.styles.f6e8f066.css" as="style"><link rel="preload" href="/front-end-knowledge/assets/js/app.aa86a262.js" as="script"><link rel="preload" href="/front-end-knowledge/assets/js/2.3d12b32d.js" as="script"><link rel="preload" href="/front-end-knowledge/assets/js/10.c4915706.js" as="script"><link rel="prefetch" href="/front-end-knowledge/assets/js/11.d845a00f.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/12.b1f77b3b.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/13.ba407ed3.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/14.d4dd4935.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/15.84b48e4e.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/16.a1459681.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/17.5bd8e776.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/18.33e6e5cc.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/19.c61d0154.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/20.9171357e.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/21.0f366cd5.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/22.d6684a55.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/23.5eb4898e.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/24.4eb512de.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/25.e2caa5d3.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/26.b323d964.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/27.0b603dc3.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/28.6c7c5f09.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/29.0d2e641f.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/3.7b89e29c.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/30.cd7d3a2f.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/31.8bc931f5.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/32.c32458ae.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/33.d8dffef6.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/34.db92ee58.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/35.acd82f37.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/36.cc98defd.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/37.c2d96035.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/38.d86e7a5f.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/39.205da352.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/4.dd3397b1.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/40.c974e0f7.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/41.8ca618c4.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/42.b526f1d8.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/43.af0779bb.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/44.b86b2b14.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/45.7106f8c8.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/46.671c7d66.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/47.b19d259b.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/48.f621fafd.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/49.200cc1ab.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/5.4d5708b9.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/50.67aa367f.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/51.5f6a0333.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/6.090c7141.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/7.721a4afd.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/8.49320607.js"><link rel="prefetch" href="/front-end-knowledge/assets/js/9.2bbbb8e5.js">
    <link rel="stylesheet" href="/front-end-knowledge/assets/css/0.styles.f6e8f066.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/front-end-knowledge/" class="home-link router-link-active"><!----> <span class="site-name">knowledge</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front-end-knowledge/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://blog.csdn.net/Jioho_chen" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitee.com/Jioho/front-end-knowledge" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front-end-knowledge/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://blog.csdn.net/Jioho_chen" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitee.com/Jioho/front-end-knowledge" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/front-end-knowledge/" aria-current="page" class="sidebar-link">Home</a></li><li><a href="/front-end-knowledge/01.写在最前面.html" class="sidebar-link">最新更新与推荐</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Java Script</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-knowledge/02.JavaScript/内置对象和普通对象.html" class="sidebar-link">内置对象有哪些?内置对象(函数对象)和普通对象区别</a></li><li><a href="/front-end-knowledge/02.JavaScript/JS事件循环机制宏任务微任务.html" class="sidebar-link">JS 事件循环机制(event loop)之宏任务/微任务</a></li><li><a href="/front-end-knowledge/02.JavaScript/创建对象的几种方式.html" class="sidebar-link">创建对象的几种方式</a></li><li><a href="/front-end-knowledge/02.JavaScript/apply-bind-call的区别.html" class="sidebar-link">apply，call，bind 区别</a></li><li><a href="/front-end-knowledge/02.JavaScript/JS的数据类型.html" class="sidebar-link">数据类型有几种类型,他们之前的区别</a></li><li><a href="/front-end-knowledge/02.JavaScript/描述一下this.html" class="sidebar-link">描述一下 this</a></li><li><a href="/front-end-knowledge/02.JavaScript/js中函数执行过程.html" class="sidebar-link">js 中函数执行过程</a></li><li><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html" class="active sidebar-link">class 与原型和原型链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#class-的声明和以前声明方式的区别：" class="sidebar-link">class 的声明和以前声明方式的区别：</a></li><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#类的方法和-prototype-上的方法" class="sidebar-link">类的方法和 prototype 上的方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#定义方法的相同点：" class="sidebar-link">定义方法的相同点：</a></li><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#定义方法的不同点：" class="sidebar-link">定义方法的不同点：</a></li></ul></li><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#constructor-方法" class="sidebar-link">constructor 方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#不同点" class="sidebar-link">不同点</a></li></ul></li><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#类的实例" class="sidebar-link">类的实例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#相同点" class="sidebar-link">相同点</a></li></ul></li><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#取值函数（getter）和存值函数（setter）" class="sidebar-link">取值函数（getter）和存值函数（setter）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#相同点-2" class="sidebar-link">相同点</a></li></ul></li><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#属性表达式" class="sidebar-link">属性表达式</a></li><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#class-表达式" class="sidebar-link">Class 表达式</a></li><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#class-的拓展和新提案" class="sidebar-link">class 的拓展和新提案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#不存在提升" class="sidebar-link">不存在提升</a></li><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#name-属性" class="sidebar-link">name 属性</a></li><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#this-的指向" class="sidebar-link">this 的指向</a></li><li class="sidebar-sub-header"><a href="/front-end-knowledge/02.JavaScript/class与原型和原型链.html#静态方法" class="sidebar-link">静态方法</a></li></ul></li></ul></li><li><a href="/front-end-knowledge/02.JavaScript/common.js和es6中模块引入的区别.html" class="sidebar-link">common.js 和 es6 中模块引入的区别？</a></li><li><a href="/front-end-knowledge/02.JavaScript/数组用法总结.html" class="sidebar-link">数组用法总结</a></li><li><a href="/front-end-knowledge/02.JavaScript/typeof和instanceof.html" class="sidebar-link">判断数据类型 typeof 和 instanceof</a></li><li><a href="/front-end-knowledge/02.JavaScript/letvarconst区别.html" class="sidebar-link">let var const 区别</a></li><li><a href="/front-end-knowledge/02.JavaScript/nullundefined的区别.html" class="sidebar-link">null，undefined 的区别</a></li><li><a href="/front-end-knowledge/02.JavaScript/new一个对象的时候发生了什么.html" class="sidebar-link">new 一个对象的过程中发生了什么?</a></li><li><a href="/front-end-knowledge/02.JavaScript/立即执行函数.html" class="sidebar-link">立即执行函数</a></li><li><a href="/front-end-knowledge/02.JavaScript/原型和原型链.html" class="sidebar-link">原型和原型链-基础,但是非常重要</a></li><li><a href="/front-end-knowledge/02.JavaScript/事件冒泡捕获委托.html" class="sidebar-link">事件冒泡，事件捕获，事件委托</a></li><li><a href="/front-end-knowledge/02.JavaScript/了解 v8 引擎吗,一段js代码如何执行的.html" class="sidebar-link">了解 v8 引擎吗，一段 js 代码如何执行的</a></li><li><a href="/front-end-knowledge/02.JavaScript/数组shift.call-arguments详解.html" class="sidebar-link">[].shift.call(arguments) 详解</a></li><li><a href="/front-end-knowledge/02.JavaScript/深拷贝浅拷贝.html" class="sidebar-link">深拷贝、浅拷贝</a></li><li><a href="/front-end-knowledge/02.JavaScript/箭头函数的特点.html" class="sidebar-link">箭头函数的特点</a></li><li><a href="/front-end-knowledge/02.JavaScript/说出==和===区别.html" class="sidebar-link">说出 == 和 ===区别，什么情况用 ==</a></li><li><a href="/front-end-knowledge/02.JavaScript/谈一下JS的类型转换.html" class="sidebar-link">谈一下 JS 的类型转换</a></li><li><a href="/front-end-knowledge/02.JavaScript/闭包.html" class="sidebar-link">闭包 进阶必问！</a></li><li><a href="/front-end-knowledge/02.JavaScript/防抖和节流.html" class="sidebar-link">防抖(debounce)和节流(throttle)</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>小程序</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="class-与原型和原型链"><a href="#class-与原型和原型链" class="header-anchor">#</a> class 与原型和原型链</h1> <h2 id="class-的声明和以前声明方式的区别："><a href="#class-的声明和以前声明方式的区别：" class="header-anchor">#</a> class 的声明和以前声明方式的区别：</h2> <p>es6 新增的 Class 其实也是语法糖，js 底层其实没有 class 的概念的，其实也是<code>原型继承的封装</code>。如果原型还不熟，一定要先看<a href="/front-end-knowledge/01.基础/原型和原型链.html">原型和原型链</a></p> <p>引用 <a href="https://es6.ruanyifeng.com/#docs/class" target="_blank" rel="noopener noreferrer">阮老师 es6 class<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 中的一段代码：</p> <p><strong>原始的构造函数</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
  <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
<span class="token punctuation">}</span>

<span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'('</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token string">', '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token string">')'</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>改用<code>class</code>来写</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
  <span class="token punctuation">}</span>

  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'('</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token string">', '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token string">')'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>这会和我们之前学习的原型和原型链冲突吗？Point 又是什么类型？</p></blockquote> <p>验证一下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">typeof</span> Point <span class="token comment">// &quot;function&quot;</span>
Point <span class="token operator">===</span> <span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token comment">// true</span>
Point<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
<span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
</code></pre></div><p>重温一下原型和原型链，完全一致</p> <p><img src="https://gitee.com/Jioho/img/raw/master/knowledge/20200614181608.png" alt=""></p> <h2 id="类的方法和-prototype-上的方法"><a href="#类的方法和-prototype-上的方法" class="header-anchor">#</a> 类的方法和 prototype 上的方法</h2> <p>构造函数的 <code>prototype</code> 属性，在 ES6 的<code>类</code>上面继续存在。事实上，类的所有方法都定义在类的 <code>prototype</code> 属性上面。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
  <span class="token function">toValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 等同于</span>
<span class="token class-name">Point</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <p><strong>如何为 class 添加方法？</strong></p> <h3 id="定义方法的相同点："><a href="#定义方法的相同点：" class="header-anchor">#</a> 定义方法的相同点：</h3> <p>之前我们为原型添加方法是：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><ul><li>那我们换到 es6 的语法，使用 class 的时候，也可以像以前一样添加方法</li> <li>也可以使用：<code>Object.assign</code> 方法，可以很方便地一次向类添加多个方法。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="定义方法的不同点："><a href="#定义方法的不同点：" class="header-anchor">#</a> 定义方法的不同点：</h3> <p>原型上的方法<code>枚举性</code></p> <ul><li><code>类</code>的<strong>内部所有定义</strong>的方法，都是<code>不可枚举</code>的（non-enumerable）</li> <li>注意只是 <code>内部所有定义的</code> 才不可枚举，不代表后面动态添加的不可枚举</li></ul> <p>看个栗子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// fn1,fn2算是内部定义的方法</span>
  <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// ....</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Point2</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Point2</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// []  因为class的方法不可枚举</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token class-name">Point2</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ['fn1','fn2']</span>

<span class="token comment">// 【重点】动态为class添加方法</span>
Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token function">fn3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">fn4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// [fn3,fn4]  只有动态添加的可以枚举</span>
</code></pre></div><hr> <p><strong>那是不是我们都不能通过代码来判断存不存在 <code>fn1</code> 和 <code>fn2</code> 呢？</strong></p> <p>可以！使用 <code>Object.getOwnPropertyNames(Point.prototype)</code>。可以看到连 constructor 都被打印出来了</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 还是上面的代码</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span><span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// [&quot;constructor&quot;, &quot;fn1&quot;, &quot;fn2&quot;, &quot;fn3&quot;, &quot;fn4&quot;]</span>
</code></pre></div><h2 id="constructor-方法"><a href="#constructor-方法" class="header-anchor">#</a> constructor 方法</h2> <blockquote><p><code>constructor</code> 方法是类的默认方法，通过 new 命令生成对象实例时，<code>自动调用该方法</code>。一个类必须有 constructor 方法，如果没有显式定义，<strong>一个空的 constructor 方法会被默认添加</strong>。</p></blockquote> <p><strong><code>constructor</code>方法默认返回实例对象（即 this），完全可以指定返回另外一个对象。</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">Foo</span> <span class="token comment">// false</span>
</code></pre></div><p>上面代码中，constructor 函数返回一个全新的对象，结果导致实例对象不是 Foo 类的实例。</p> <h3 id="不同点"><a href="#不同点" class="header-anchor">#</a> 不同点</h3> <p>类必须使用 <code>new</code> 调用，否则会报错。这是它跟普通构造函数的一个主要区别，<code>后者不用 new 也可以执行</code>。</p> <h2 id="类的实例"><a href="#类的实例" class="header-anchor">#</a> 类的实例</h2> <h3 id="相同点"><a href="#相同点" class="header-anchor">#</a> 相同点</h3> <ul><li>生成类的实例的写法，与 ES5 完全一样，也是使用 <code>new</code> 命令</li> <li>实例的属性除非<code>显式定义在其本身</code>（即定义在 this 对象上），否则都是<code>定义在原型上</code>（即定义在 class 上）。</li> <li>类的所有实例共享一个原型对象。</li></ul> <p><strong>实例的属性的论证</strong></p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre class="language-js"><code><span class="token comment">//定义类</span>
<span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
  <span class="token punctuation">}</span>

  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'('</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token string">', '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token string">')'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> point <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

point<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// (2, 3)</span>
poinit<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">3</span>
point<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
point<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
point<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
point<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'toString'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
point<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'toString'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><blockquote><p>留意高亮的几行代码。<code>x</code>,<code>y</code> 都是定义在 <code>this</code> 对象上。包括后来的<code>z</code>也还在 this 对象上</p> <p>而 toString 方法。point 可以调用，可是是挂载了 <code>Point</code> 这个类中</p> <p>这些都与 ES5 的行为保持一致。</p></blockquote> <hr> <p><strong>类的所有实例共享一个原型对象</strong></p> <ul><li><p>ES5 的例子:</p> <p>可以查看 <a href="/front-end-knowledge/01.基础/原型和原型链.html#这样的链条，有什么作用呢？用处体现在哪里？">原型和原型链中的一个题目 8</a></p> <p>这就是因为题目中的所有实例都共享同一个原型对象，<strong>一个实例中修改原型对象，其余的实例都会受到影响。</strong></p> <p>当然，要慎用！！极度不推荐这么操作，隐蔽性太高，后续维护会很困难</p></li> <li><p>class 中如何证明</p></li></ul> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre class="language-js"><code><span class="token comment">// class Point ... 省略不写了</span>
<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

p1<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> p2<span class="token punctuation">.</span>__proto__ <span class="token comment">//true</span>

<span class="token comment">// 注意这里是 p1 通过原型链，添加了一个 printName 方法</span>
p1<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span><span class="token function-variable function">printName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'Oops'</span>
<span class="token punctuation">}</span>

p1<span class="token punctuation">.</span><span class="token function">printName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;Oops&quot;</span>
<span class="token comment">// p2 也可以调用</span>
p2<span class="token punctuation">.</span><span class="token function">printName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;Oops&quot;</span>

<span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">// 后来生成的p3 还有这个方法！</span>
p3<span class="token punctuation">.</span><span class="token function">printName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;Oops&quot;</span>
</code></pre></div><h2 id="取值函数（getter）和存值函数（setter）"><a href="#取值函数（getter）和存值函数（setter）" class="header-anchor">#</a> 取值函数（getter）和存值函数（setter）</h2> <h3 id="相同点-2"><a href="#相同点-2" class="header-anchor">#</a> 相同点</h3> <p><code>类</code>的内部可以使用 <code>get</code> 和 <code>set</code> 关键字，对某个属性设置存值函数和取值函数，拦截该属性的存取行为。</p> <ul><li>ES5 写法:</li></ul> <blockquote><p>vue 2.x 框架就是利用 <code>Object.defineProperty</code> 进行数据挟持（set 的时候触发自己的方法，get 的时候也是返回对应的值），达到的双向数据绑定</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> prop <span class="token operator">=</span> <span class="token string">''</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'prop'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'getter'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setter: '</span> <span class="token operator">+</span> value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> inst <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
inst<span class="token punctuation">.</span>prop <span class="token operator">=</span> <span class="token number">123</span> <span class="token comment">// setter: 123</span>

inst<span class="token punctuation">.</span>prop <span class="token comment">// getter</span>
</code></pre></div><ul><li>等价于 ES6</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">get</span> <span class="token function">prop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'getter'</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">set</span> <span class="token function">prop</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setter: '</span> <span class="token operator">+</span> value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> inst <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

inst<span class="token punctuation">.</span>prop <span class="token operator">=</span> <span class="token number">123</span>
<span class="token comment">// setter: 123</span>

inst<span class="token punctuation">.</span>prop
<span class="token comment">// 'getter'</span>
</code></pre></div><h2 id="属性表达式"><a href="#属性表达式" class="header-anchor">#</a> 属性表达式</h2> <p>类的属性名，可以采用表达式。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> methodName <span class="token operator">=</span> <span class="token string">'getArea'</span>
<span class="token keyword">class</span> <span class="token class-name">Square</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">length</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">[</span>methodName<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Square</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">getArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 可以调用</span>
s<span class="token punctuation">.</span><span class="token function">methodName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 报错</span>
</code></pre></div><h2 id="class-表达式"><a href="#class-表达式" class="header-anchor">#</a> Class 表达式</h2> <p>与函数一样，类也可以使用表达式的形式定义。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> MyClass <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">Me</span> <span class="token punctuation">{</span>
  <span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Me<span class="token punctuation">.</span>name
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">需要注意的是，这个类的名字是 `Me`，但是 `Me 只在 Class 的内部可用`，指代当前类。在 Class 外部，这个类只能用 MyClass 引用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> inst <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
inst<span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Me</span>
Me<span class="token punctuation">.</span>name <span class="token comment">// ReferenceError: Me is not defined</span>
</code></pre></div></div> <div class="custom-block tip"><p class="custom-block-title">如果类的内部没用到的话，可以省略 Me，也就是可以写成下面的形式。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> MyClass <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h2 id="class-的拓展和新提案"><a href="#class-的拓展和新提案" class="header-anchor">#</a> class 的拓展和新提案</h2> <h3 id="不存在提升"><a href="#不存在提升" class="header-anchor">#</a> 不存在提升</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// ReferenceError</span>
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="name-属性"><a href="#name-属性" class="header-anchor">#</a> name 属性</h3> <p>由于本质上，ES6 的类只是 ES5 的构造函数的一层包装，所以函数的许多特性都被 Class 继承，<code>包括 name 属性</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Point<span class="token punctuation">.</span>name <span class="token comment">// &quot;Point&quot;</span>
</code></pre></div><h3 id="this-的指向"><a href="#this-的指向" class="header-anchor">#</a> this 的指向</h3> <p>类的方法内部如果含有 <code>this</code>，它默认指向类的实例。但是，必须非常小心，一旦单独使用该方法，很可能报错。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Logger</span> <span class="token punctuation">{</span>
  <span class="token function">printName</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">'there'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">print</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> printName <span class="token punctuation">}</span> <span class="token operator">=</span> logger
<span class="token function">printName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// TypeError: Cannot read property 'print' of undefined</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>上面代码中，<code>printName</code> 方法中的 this，默认指向 Logger 类的实例。</p> <p>但是，如果将这个方法提取出来单独使用，<code>this 会指向该方法运行时所在的环境</code>（由于 class 内部是严格模式，所以 this 实际指向的是 undefined），从而导致找不到 print 方法而报错。</p></div> <p>解决方法：</p> <p>(1) 在构造函数中绑定 <code>this</code> 指向</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Logger</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>printName <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">printName</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>(2) 另一种解决方法是使用<code>箭头函数</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Obj</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getThis</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> myObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Obj</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
myObj<span class="token punctuation">.</span><span class="token function">getThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> myObj <span class="token comment">// true</span>
</code></pre></div><p>(3) 使用 <code>proxy</code> 获取的时候自动绑定 this</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">selfish</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> value <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> value
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cache<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token function">value</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
  <span class="token keyword">return</span> proxy
<span class="token punctuation">}</span>

<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">selfish</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="静态方法"><a href="#静态方法" class="header-anchor">#</a> 静态方法</h3> <p>类相当于实例的原型，所有在类中定义的方法，都会被实例继承。</p> <p>如果在一个方法前，加上 static 关键字，就表示该方法<code>不会被实例继承</code>，而是直接通过类来调用，这就称为<code>静态方法</code>。</p> <blockquote><p>Foo 类的 <code>classMethod</code> 方法前有 <code>static</code> 关键字，表明该方法是一个静态方法，可以直接在 Foo 类上调用（<code>Foo.classMethod()</code>），而不是在 Foo 类的实例上调用。如果在实例上调用静态方法，会抛出一个错误，表示不存在该方法。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">classMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'hello'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Foo<span class="token punctuation">.</span><span class="token function">classMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'hello'</span>

<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
foo<span class="token punctuation">.</span><span class="token function">classMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// TypeError: foo.classMethod is not a function</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>如果静态方法包含 <code>this</code> 关键字，这个 this 指的是<code>类</code>，而<code>不是实例</code>。</p> <p>另外，从这个例子还可以看出，静态方法可以与非静态方法重名。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'world'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// hello</span>
</code></pre></div></div> <p>父类的静态方法，可以被子类继承。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">classMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'hello'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Bar</span> <span class="token keyword">extends</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 注意继承后还是静态方法，调用方式还是直接调用</span>
Bar<span class="token punctuation">.</span><span class="token function">classMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'hello'</span>
</code></pre></div><p>静态方法也是可以从 <code>super</code> 对象上调用的。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">classMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'hello'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Bar</span> <span class="token keyword">extends</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">classMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">classMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">', too'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Bar<span class="token punctuation">.</span><span class="token function">classMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;hello, too&quot;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/24/2020, 4:50:50 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/front-end-knowledge/02.JavaScript/js中函数执行过程.html" class="prev">
        js 中函数执行过程
      </a></span> <span class="next"><a href="/front-end-knowledge/02.JavaScript/common.js和es6中模块引入的区别.html">
        common.js 和 es6 中模块引入的区别？
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:0px;bottom:-30px;width:180px;height:400px;z-index:99999;opacity:1;pointer-events:none;"><canvas id="live2d_canvas" width="180" height="400" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:180px;height:400px;"></canvas></div></div></div>
    <script src="/front-end-knowledge/assets/js/app.aa86a262.js" defer></script><script src="/front-end-knowledge/assets/js/2.3d12b32d.js" defer></script><script src="/front-end-knowledge/assets/js/10.c4915706.js" defer></script>
  </body>
</html>
